/* v1.0.2 — RIDDIM INDEX Twitch-dark theme + touch-hover + split hover (PC/mobile) */

:root{
  /* spacing tokens */
  --sp-2: 2px;
  --sp-4: 4px;
  --sp-6: 6px;
  --sp-8: 8px;
  --sp-10: 10px;
  --sp-12: 12px;
  --ctl-h: 36px;

  /* Twitch-like colors */
  --navy-bg:   #0e0e10;  /* page background */
  --navy-card: #18181b;  /* card background */
  --navy-line: #26262c;  /* solid border */
  --navy-dash: #26262c;  /* dashed border */
  --mint:      #9146ff;  /* primary accent (Twitch purple) */
  --text:      #f7f7f8;  /* main text */
  --text-soft: #c8c8d0;  /* softer text */
  --chip-bg:   #1f1f23;  /* input / chip bg */

  /* base font size (mobile / tablet) */
  --fs: 14px;

  /* Detail alignment geometry
     card-left=10px, metaGrid-left=10px, metaRow-inner-left=6px
     -> align-left = 16px from card inner
  */
  --card-left:    10px;
  --metagrid-left:10px;
  --metarow-left: 6px;
  --align-left:   calc(var(--metagrid-left) + var(--metarow-left)); /* 16px from card inner */
  --title-pad-left: calc(var(--align-left) - var(--card-left));     /* extra inside .cardHead */
}

*{ box-sizing:border-box; }

html,
body{
  height:100%;
}

body{
  margin:0;
  background:var(--navy-bg);
  color:var(--text);
  font:var(--fs)/1.45 -apple-system, BlinkMacSystemFont, "Segoe UI",
       "Helvetica Neue", Arial, sans-serif;
  font-variant-numeric: tabular-nums;
  -webkit-text-size-adjust:100%;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ========== Layout base ========== */

.container{
  width:calc(100% - 24px);
  max-width:800px;
  margin:0 auto;
}

/* ========== Masthead / Title / Search ========== */

.masthead{
  padding:16px 0 4px;
  border-bottom:none;
  background:transparent;
}

.title{
  margin:0;
  font-size:26px; /* 少し大きめ */
  font-weight:800;
  letter-spacing:.2px;
}

.title .ver{
  font-size:11px;
  color:var(--mint);
  margin-left:6px;
}

.titleline{
  height:1px;
  background:var(--navy-line);
  margin:4px 0;
}

.masthead .input{
  margin-top:4px;
}

/* clickable title link back to index */
.titleLink{
  color:inherit;
  text-decoration:none;
  cursor:pointer;
}

.titleLink:visited{
  color:inherit;
}

@media (hover:hover){
  .titleLink:hover{
    text-decoration:none;
  }
}

/* ========== Inputs ========== */

.input{
  height:var(--ctl-h);
  width:100%;
  background:var(--chip-bg);
  border:1px solid var(--navy-line);
  border-radius:10px;
  padding:0 12px;
  color:var(--text-soft);
  outline:none;
  font-size:var(--fs);
}

.input::placeholder{
  color:var(--text-soft);
  opacity:.7;
}

.input:focus{
  border-color:var(--mint);
}

/* ========== Filters (label/year selects) ========== */

.filters{
  margin-top:4px;
  display:flex;
  gap:var(--sp-10);
  padding:0;
  border-bottom:none;
  background:transparent;
}

.filters select{
  height:var(--ctl-h);
  min-width:150px;
  background:var(--chip-bg);
  border:1px solid var(--navy-line);
  border-radius:10px;
  color:var(--text-soft);
  padding:0 12px;
  font-size:var(--fs);
}

.filters select:focus{
  border-color:var(--mint);
}

.meta{
  margin-top:var(--sp-8);
  margin-bottom:0;
  color:var(--text-soft);
}

@media (max-width:700px){
  .meta{
    margin-bottom:2px;
  }
}

/* ========== Card (共通) ========== */

.card{
  margin:12px auto;
  background:var(--navy-card);
  border:1px solid var(--navy-line);
  border-radius:12px;
  display:flex;
  flex-direction:column;
  min-height:0;
  overflow:hidden;
}

/* 旧ソートボタン用（現状未使用だが残しておく） */
.toolbar{
  display:flex;
  gap:8px;
  align-items:center;
}

.toolbar--in{
  padding:8px 10px;
  border-bottom:1px solid var(--navy-line);
}

.sortBtn{
  height:var(--ctl-h);
  background:var(--chip-bg);
  border:1px solid var(--navy-line);
  border-radius:10px;
  color:var(--text-soft);
  padding:0 10px;
  min-width:110px;
  display:flex;
  align-items:center;
  gap:8px;
  justify-content:center;
  cursor:pointer;
}

.sortBtn.active{
  border-color:var(--mint);
  color:var(--mint);
  background:#211f35;
}

.sortBtn .dir{
  opacity:.7;
  width:1em;
  text-align:center;
}

/* ========== Index: header row (Riddim / レーベル / リリース年) ========== */

.columns{
  display:flex;
  gap:2px;
  align-items:center;
  padding:6px 10px;
  border-bottom:1px solid var(--navy-line);
  color:var(--text-soft);
}

.columns .name{
  flex:1 1 45%;
  min-width:120px;
  cursor:pointer;
}

.columns .label{
  flex:1 1 45%;
  min-width:120px;
  cursor:pointer;
}

.columns .year{
  flex:0 0 76px;
  text-align:right;
  white-space:nowrap;
  cursor:pointer;
}

.columns .sorted{
  color:var(--mint);
}

/* ========== Index: list / rows ========== */

.list{
  flex:1 1 auto;
  min-height:120px;
  overflow:auto;
  padding:0 var(--sp-6);
}

.row{
  display:flex;
  gap:6px;
  align-items:center;
  padding:var(--sp-6) var(--sp-6);
  border-bottom:1px dashed var(--navy-dash);
  color:var(--text-soft);
}

.row:last-child{
  border-bottom:none;
}

.name{
  flex:1 1 45%;
  min-width:120px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

.label{
  flex:1 1 45%;
  min-width:120px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

.year{
  flex:0 0 76px;
  text-align:right;
  white-space:nowrap;
}

/* hoverable rows in index: ベースのホバー用レイヤー */
.row.row--click{
  position:relative;
  cursor:pointer;
}

.row.row--click::before{
  content:"";
  position:absolute;
  inset:0;
  background:rgba(255,255,255,0.05); /* 0.05 に統一 */
  opacity:0;
  pointer-events:none;
  transition:opacity .12s ease;
}

/* PC だけ :hover で発火させる */
@media (hover:hover){
  .row.row--click:hover::before{
    opacity:1;
  }
}

/* スマホ／タッチは JS から touch-hover クラスで発火 */
.row.row--click.touch-hover::before{
  opacity:1;
}

/* ========== Index: responsive columns (mobile) ========== */

@media (max-width:900px){
  .columns{
    display:grid;
    grid-template-columns:1.2fr 0.8fr 76px;
    grid-template-areas:"name label year";
    gap:4px 8px;
    padding:10px 10px;
  }

  .columns .label{
    padding-left:23px;
  }

  .row{
    display:grid;
    grid-template-columns:1.2fr 0.8fr 76px;
    grid-template-areas:"name label year";
    gap:4px 8px;
    padding:10px 8px;
  }

  .row>.name{
    grid-area:name;
    min-width:0;
    overflow:hidden;
    text-overflow:ellipsis;
    white-space:nowrap;
  }

  .row>.label{
    grid-area:label;
    min-width:0;
    overflow:visible;
    text-overflow:clip;
    white-space:nowrap;
    padding-left:8px;
  }

  .row>.year{
    grid-area:year;
  }
}

/* ========== Index: sticky header (PC) ========== */

@media (min-width:901px){
  .sticky-head{
    position:sticky;
    top:0;
    z-index:50;
    background:var(--navy-card);
  }
}

/* ========== Detail page: card head + YouTube button ========== */

.cardHead{
  padding:6px 10px;
  border-bottom:1px solid var(--navy-line);
}

/* タイトル行 + YouTube ボタン用ラッパー */
.cardHead__row{
  display:flex;
  align-items:center;
  gap:8px;
}

/* Riddim名 / PICKUP 見出し */
.cardHead__title{
  margin:0;
  font-size:18px;
  font-weight:400;
  letter-spacing:0;
  color:var(--text);
  padding-left:var(--title-pad-left); /* = 16px from card inner */
  flex:0 1 auto;
  margin-right:0;
}

/* 丸い YouTube ボタン */
.ytBtn{
  flex:0 0 auto;
  width:26px;
  height:26px;
  border-radius:999px;
  border:1px solid var(--navy-line);
  background:var(--chip-bg);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0;
  cursor:pointer;
}

.ytBtn:focus{
  outline:1px solid var(--mint);
  outline-offset:2px;
}

/* 再生マーク（三角形） */
.ytIcon{
  width:0;
  height:0;
  border-style:solid;
  border-width:5px 0 5px 9px;
  border-color:transparent transparent transparent var(--text-soft);
  margin-left:1px;
}

@media (hover:hover){
  .ytBtn:hover{
    border-color:var(--mint);
  }
}

/* ========== Detail: meta info grid ========== */

.metaGrid{
  display:grid;
  grid-template-columns:1fr;
  gap:0;
  padding:0 10px;
}

.metaRow{
  display:grid;
  grid-template-columns:160px 1fr;
  gap:0;
  padding:8px 6px;
  border-bottom:1px dashed var(--navy-dash);
}

.metaRow:last-child{
  border-bottom:none;
}

.metaKey{
  color:var(--text-soft);
  font-weight:400;
}

.metaVal{
  color:var(--text-soft);
  margin-left:-35px;
}

/* ========== Detail: PICKUP song list ========== */

.songList{
  list-style:none;
  margin:0;
  padding:0 10px;
}

/* song rows (共通) */
.songRow{
  display:flex;
  align-items:center;
  gap:4px;
  padding:8px 0;
  border-bottom:1px dashed var(--navy-dash);
  color:var(--text-soft);
  position:relative;   /* ← ホバー用レイヤーの基準 */
  overflow:hidden;     /* ← はみ出し防止 */
}

.songRow:last-child{
  border-bottom:none;
}

.songRow .dot{
  position:relative;
  left:-0.1em;
  width:0.8em;
  display:inline-block;
  color:var(--text-soft);
  -webkit-user-select:none;
  user-select:none;
  pointer-events:none;
  margin-left:6px;
}

.songRow .artist{
  font-weight:400;
}

.songRow .title{
  font-weight:400;
  font-size:inherit;
}

.songRow .sep{
  opacity:.7;
  -webkit-user-select:none;
  user-select:none;
  pointer-events:none;
}

/* Detail song hover: インデックスと同じく ::before で破線を避ける */
.songRow::before{
  content:"";
  position:absolute;
  left:0;
  right:0;
  top:0;
  bottom:0;
  background:rgba(255,255,255,0.05); /* 0.05 に統一 */
  opacity:0;
  pointer-events:none;
  transition:opacity .12s ease;
}

/* PC の :hover */
@media (hover:hover){
  .songRow:hover::before{
    opacity:1;
  }
}

/* スマホ用 touch-hover（detail.js からクラス付与） */
.songRow.touch-hover::before{
  opacity:1;
}

/* Songs align using UL padding; LI has no extra left padding */
.card .songList{
  list-style:none;
  margin:0;
  padding-left:10px;
  padding-right:10px;
}

.card .songList li,
.card .songRow{
  padding-left:0;
}

/* PICKUP の YouTube リンク */
.songLink{
  display:flex;
  align-items:center;
  gap:4px;
  width:100%;
  color:var(--text-soft);
  text-decoration:none;
  -webkit-tap-highlight-color:transparent;
}

.songLink:visited{
  color:var(--text-soft);
}

@media (hover:hover){
  .songLink:hover{
    text-decoration:none;
  }
}

/* モバイル時の PICKUP 行：1行固定＋横スクロール */
@media (max-width:768px){
  .songRow{
    overflow-x:auto !important;
    -webkit-overflow-scrolling:touch;
  }

  .songRow .songLink{
    display:inline-block !important;
    white-space:nowrap !important;
    min-width:100%;
  }

  .songRow .songLink .artist,
  .songRow .songLink .title,
  .songRow .songLink .sep,
  .songRow .songLink .dot{
    white-space:nowrap !important;
  }
}

/* ========== Footer note (注意書き) ========== */

.footerNote{
  text-align:center;
  color:var(--text-soft);
  opacity:.6;
  font-size:10px;
  padding:15px 0 20px;
  line-height:1.4;
}

@media (max-width:600px){
  .footerNote{
    font-size:8px;
  }
}

/* ========== Detail page layout ========== */

body.detailPage{
  display:flex;
  flex-direction:column;
  height:100%;
  overflow:hidden;
}

/* ヘッダーの詰めだけ従来どおり */
.detailPage .masthead{
  padding:16px 0 0;
  margin-bottom:-4px;
}

.detailPage .titleline{
  margin:4px 0;
}

/* 1枚目（リディムカード） */
body.detailPage .card.container:first-of-type{
  flex:0 0 auto;
  margin-top:8px;
  margin-bottom:9px;
}

/* 2枚目（PICKUPカード） */
body.detailPage .card.container:nth-of-type(2){
  flex:0 0 auto;
  min-height:0;
  margin-top:0;
  margin-bottom:0;
  display:flex;
  flex-direction:column;
}

/* PICKUP 見出しは固定高さ */
body.detailPage .card.container:nth-of-type(2) .cardHead{
  flex:0 0 auto;
}

/* 曲リストだけスクロール対象。高さは JS で入れる --pickup-max-height を使う。 */
body.detailPage .card.container:nth-of-type(2) .songList{
  flex:1 1 auto;
  min-height:0;
  max-height:var(--pickup-max-height, 320px);
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
}

/* Detail の注意書きは一番下に固定で常に見える */
body.detailPage .footerNote{
  flex:0 0 auto;
}

/* ========== Index page layout ========== */

body.indexPage{
  display:flex;
  flex-direction:column;
  height:100%;
  overflow:hidden;
}

/* インデックスのカード（一覧カード）を残り高さぜんぶ使う */
body.indexPage .card.container{
  flex:1 1 auto;
  min-height:0;
  display:flex;
  flex-direction:column;
  margin-top:0;
  margin-bottom:0;
}

/* ヘッダー行 */
body.indexPage .card.container .columns{
  flex:0 0 auto;
}

/* リストだけスクロールさせる */
body.indexPage .card.container .list{
  flex:1 1 auto;
  min-height:0;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
}

/* インデックスページでも注意書きを下に固定 */
body.indexPage .footerNote{
  flex:0 0 auto;
}

/* Index: 最終行が伸びる問題の完全修正 */
body.indexPage .card .list{
  min-height:0 !important;
  max-height:none !important;
  flex:1 1 auto;
}

body.indexPage .card .row:last-child{
  margin-bottom:0 !important;
  padding-bottom:8px;
}

@media (max-width:900px){
  body.indexPage .list{
    max-height:none;
    min-height:0;
  }
}

/* ========== PC（デスクトップ）専用：フォントサイズUP ========== */

@media (min-width:901px){
  :root{
    --fs:16px;
  }
  .metaVal {
    margin-left: -20px;
  }
}

/* スマホ時：詳細ページの曲行もインデックスと同じくらいの余白にする */
@media (max-width:900px){
  .songRow{
    padding:10px 0;  /* もとの 8px → 10px に拡張 */
  }
}
